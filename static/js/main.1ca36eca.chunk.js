(this["webpackJsonpmangrove-carbon-app"]=this["webpackJsonpmangrove-carbon-app"]||[]).push([[0],{221:function(e,t,n){},228:function(e,t,n){},237:function(e,t,n){},238:function(e,t,n){},240:function(e,t,n){},415:function(e,t,n){},416:function(e,t,n){},418:function(e,t,n){},419:function(e,t,n){},420:function(e,t,n){},423:function(e,t,n){"use strict";n.r(t);var a=n(2),o=n(1),r=n.n(o),s=n(24),i=n.n(s),c=(n(221),n(14)),l=n(17),u=n(184),d=n(8),b=n(13),j=n(36),f=n(11),p=n.n(f),m=n(163),h=n.n(m),O=n(164),v=n.n(O),x=n(74),g=n.n(x),y=function(e){var t=e.isSmall,n=void 0!==t&&t,o=Object(l.a)(e,["isSmall"]),r=n?25:66;return Object(a.jsx)("svg",Object(d.a)(Object(d.a)({className:g.a.spinner,"data-testid":"spinner",width:r,height:r,viewBox:"0 0 ".concat(r," ").concat(r),xmlns:"http://www.w3.org/2000/svg"},o),{},{children:Object(a.jsx)("circle",{className:n?g.a.pathSmall:g.a.path,fill:"none",strokeWidth:r/10,strokeLinecap:"round",cx:r/2,cy:r/2,r:r/2-3})}))},S=n(106),C=n.n(S),I=n(165);n.n(I).a;var M=["#113280","#ffa600","#8a2f89","#ff6247","#d73171"],N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"OrRd",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return C.a.scale(e).colors(t)},w=(n(228),function(e){var t=e.mapColours,n=t.colourKeyName,o=t.colourKeyUnit,r=t.colourStops,s=t.valueStops,i=t.opacity;return Object(a.jsxs)("div",{className:"Map--Overlays--Box MapLegend",children:[Object(a.jsxs)("h4",{className:"MapLegend--Title",children:[n,Object(a.jsx)("br",{}),Object(a.jsxs)("span",{className:"MapLegend--Unit",children:["(",o,")"]})]}),Object(a.jsx)("div",{className:"MapLegend--Display",children:r.map((function(e,t){var n=null===s||void 0===s?void 0:s[t],o=null===s||void 0===s?void 0:s[t+1];if(!p.a.isNumber(n)||!p.a.isNumber(o))return null;var c,l,u=function(e){return e.toFixed(0)},d="".concat(u(n)," - ").concat(u(o));return 0===t&&(d="< ".concat(u(o))),t===r.length-1&&(d="> ".concat(u(n))),Object(a.jsxs)("div",{className:"MapLegend--ColourStop",children:[Object(a.jsx)("div",{className:"MapLegend--ColourBox",style:{background:(c=e,l=i,C()(c).alpha(l))}}),Object(a.jsx)("div",{className:"MapLegend--Value",children:d})]},"MapLegend--ColourStop--".concat(t))}))})]})}),P=function(e){var t=e.Icon,n=e.onClick,o=Object(l.a)(e,["Icon","onClick"]);return Object(a.jsx)(t,Object(d.a)({role:"button",onClick:n,onKeyDown:function(e){"Space"!==e.code&&"Enter"!==e.code||n(e)},tabIndex:0,"aria-pressed":"false"},o))},T=n(47),R=n.n(T),E=n(29);n(237);R.a.setAppElement("#root");var A=function(e){var t=e.title,n=e.modalIsOpen,o=e.setModalIsOpen,r=e.children;function s(){o(!1)}return Object(a.jsxs)(R.a,{isOpen:n,onAfterOpen:function(){},onRequestClose:s,className:"Popup--Modal",overlayClassName:"Popup--Overlay",children:[Object(a.jsxs)("div",{className:"Popup--Modal--Inner",children:[t&&Object(a.jsx)("h3",{className:"Popup--Title",children:t}),Object(a.jsx)("div",{className:"Popup--Content",children:r})]}),Object(a.jsx)(P,{Icon:E.a,className:"Popup--CloseButton",onClick:s})]})},D=(n(238),function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h4",{children:"Nations measure the amount of carbon stored in their forests and wetlands when calculating their total carbon emissions."}),Object(a.jsx)("p",{children:"Mangroves have among the highest carbon densities of any tropical forest and are referred to as \u201cblue carbon\u201d ecosystems. Much of this carbon is stored in the soils beneath the trees, a stock of carbon that was historically overlooked in national carbon accounts."}),Object(a.jsx)("p",{children:"This web app is designed to help you explore the contribution of mangrove protection to mitigating emissions. The app will predict forgone opportunities to store carbon, given a rate of deforestation. These predictions tell us how much carbon would be stored in the mangrove forests if deforestation was prevented. They include carbon emitted when mangroves are deforested and missed opportunities to sequester carbon in mangroves that are deforested."}),Object(a.jsxs)("p",{children:["Predictions for future emissions cannot be made with perfect certainty. These predictions depend on the accuracy of measurements of mangrove area, carbon storage, carbon sequestration and the rate of deforestation. Errors in these inputs, especially the rate of deforestation, will affect the predictions for emissions. However, the results at the national scale are"," ",Object(a.jsx)("a",{href:"https://www.biorxiv.org/content/10.1101/2020.08.27.271189v1",children:"robust for comparing hotspots of emissions across countries"}),"."]}),Object(a.jsxs)("p",{children:["The app uses models and data from the publications:"," ",Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{children:[Object(a.jsx)("a",{href:"https://doi.org/10.1111/conl.12445",children:"The undervalued contribution of mangrove protection in Mexico to carbon emission targets"}),Object(a.jsx)("br",{})," \u2013 ","Adame et al. 2018"]}),Object(a.jsxs)("li",{children:[Object(a.jsx)("a",{href:"https://www.biorxiv.org/content/10.1101/2020.08.27.271189v1",children:"Future carbon emissions from global mangrove forest loss"}),Object(a.jsx)("br",{})," \u2013 ","Adame et al. 2020"]}),Object(a.jsxs)("li",{children:["data from the"," ",Object(a.jsx)("a",{href:"https://globalmangrovewatch.org",children:"Global Mangrove Watch"}),"."," "]})]}),Object(a.jsx)("strong",{children:"Please cite these publication if you use output from this app or the associated data."})]}),Object(a.jsx)("br",{}),Object(a.jsx)("h3",{children:"Instructions"}),Object(a.jsxs)("p",{children:["Click on any country to view country specific information about carbon and projected emissions. To compare future scenarios, set your"," ",Object(a.jsx)("strong",{children:"Forecast Years"})," and click ",Object(a.jsx)("strong",{children:"+ Add Series"})," ","and change the deforestation rate (you can add more than one series)."]}),Object(a.jsxs)("p",{children:["To place a dollar value on these emissions, click the drop down next to the ",Object(a.jsx)("strong",{children:"Projected Emissions"})," graph title and switch from"," ",Object(a.jsx)("strong",{children:"Mt CO2e"})," to ",Object(a.jsx)("strong",{children:"Price (USD)"}),". On the left you will now see that ",Object(a.jsx)("strong",{children:"Carbon Price"})," has appeared below"," ",Object(a.jsx)("strong",{children:"Forecast Years"}),". Different carbon prices are used around the world. To find out what carbon price might be appropriate for a specific area, visit"," ",Object(a.jsx)("a",{href:"https://www.worldbank.org/en/programs/pricing-carbon",children:"worldbank.org/en/programs/pricing-carbon"}),"."]}),Object(a.jsx)("br",{}),Object(a.jsx)("h3",{children:"MIT License"}),Object(a.jsx)("p",{children:"Copyright (c) 2021 The Global Wetlands Project"}),Object(a.jsx)("p",{children:'Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:'}),Object(a.jsx)("p",{children:"The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software."}),Object(a.jsx)("p",{children:'THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.'}),Object(a.jsx)("br",{})]})}),_=function(e){return Object(a.jsxs)("svg",Object(d.a)(Object(d.a)({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},e),{},{children:[Object(a.jsx)("circle",{cx:"12",cy:"12",r:"11.5"}),Object(a.jsx)("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),Object(a.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}))},F=function(){var e=Object(o.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1],s=Object(b.c)((function(e){return e.globalSettings.showMenuHelpText}));return Object(a.jsxs)(o.Fragment,{children:[Object(a.jsxs)("div",{className:"Menu--MenuButtonWrap","data-hashelptext":s,children:[Object(a.jsx)(P,{Icon:_,onClick:function(){r(!0)},className:"Menu--MenuButton",title:"Open Menu",tabIndex:1}),Object(a.jsx)("div",{className:"Menu--HelpText",children:"Click on a country to get started"})]}),Object(a.jsx)(A,{title:"Mangrove Carbon App",modalIsOpen:n,setModalIsOpen:r,children:Object(a.jsx)(D,{})})]})},k=n(42),L=n(20),Y=n.n(L),H=n(48),W=n(107),B=n.n(W),V=n(166),K=n(167);function q(e){return 1e-4*e}function U(e){return e/1e6}function G(e){var t=e.t,n=e.A1,a=e.d,o=e.r,r=void 0===o?.1:o,s=e.Cmax,i=e.s,c={t:t,A1:n,d:a,r:r,Cmax:s,s:void 0===i?0:i};return a<0?0:r===a?function(e){var t=e.t,n=e.A1,a=e.d,o=(e.r,e.Cmax),r=e.s,s=n*r*(1-Math.exp(-a*t))/a-n*o*(1-Math.exp(-a*t)-a*t*Math.exp(-a*t))-n*r*t;return-1*s}(c):function(e){var t=e.t,n=e.A1,a=e.d,o=e.r,r=e.Cmax,s=e.s,i=n*s*(1-Math.exp(-a*t))/a-n*r*(a*Math.exp(-o*t)-o*Math.exp(-a*t)+(o-a))/(o-a)-n*s*t;return-1*i}(c)}var z=1,J=6.49,X=function(){var e=Object(H.a)(Y.a.mark((function e(t){var n,a,o,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.type,a=void 0===n?"country":n,o="".concat("","/geojson/").concat(a,"_locations.json"),console.log("Loading locations data",o),e.next=5,fetch(o).then((function(e){return e.json()}));case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(H.a)(Y.a.mark((function e(t){var n,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading location ".concat(t," data")),n="".concat("","/locations_data/").concat(t,".json"),a=fetch(n).then((function(e){return e.json()})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Q(e){var t,n=e.locationData,a=e.historicalDates,o=void 0===a?["1996-01-01","2016-01-01"]:a,r=n.mangrove_datum,s=B()(o[1]).diff(B()(o[0]),"year"),i=[r.find((function(e){return e.date===o[0]})),r.find((function(e){return e.date===o[1]}))],c=i[0].area_m2,l=i[1].area_m2,u=q(c-l),d=q(l),b=i[1],j=b.agb_tco2e,f=b.bgb_tco2e,p=b.toc_tco2e,m=b.soc_tco2e,h=Math.log(l/c)/s*-1;return{historicalTimeDiff:s,current_area_ha:d,loss_ha:u,deforestationRate:h,deforestationRatePercent:(t=h,100*(Math.exp(t)-1)),emissionsFactor:z,sequestrationRate:J,agb_tco2e:j,bgb_tco2e:f,toc_tco2e:p,soc_tco2e:m,carbonStoredPerHectare:p/d}}function $(e){var t=e.current_area_ha,n=e.deforestationRate,a=e.carbonStoredPerHectare,o=e.emissionsFactor,r=void 0===o?z:o,s=e.sequestrationRate,i=void 0===s?J:s,c=e.forecastYears,l=void 0===c?50:c,u=l>100?l/100:1,d=p.a.range(1,l+1,u),b=r*a;return d.map((function(e){return G({t:e,A1:t,d:n,Cmax:b,s:i})}))}function ee(e){var t=e.seriesResults,n=e.forecastStartingYear,a=e.conversionRate,o=void 0===a?1:a;return t.reduce((function(e,t,a){var r=t.map((function(e,t){return Object(k.a)({name:t+n},"series_".concat(a),e*o)}));return e=r.map((function(t){var n=e.find((function(e){return e.name===t.name}))||{};return n=Object(d.a)(Object(d.a)({},n),t)}))}),[])}function te(){return(te=Object(H.a)(Y.a.mark((function e(t){var n,a,o,r,s,i,c;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,a=t.filename,o=void 0===a?"".concat(new Date,".csv"):a,r=t.options,s=void 0===r?{}:r,e.next=3,Object(V.parseAsync)(n,s);case 3:i=e.sent,c=new Blob([i],{type:"text/csv;charset=utf-8"}),Object(K.saveAs)(c,o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ne={current_area_ha:function(e){return p.a.round(e)},deforestationRatePercent:function(e){return p.a.round(e,3)},sequestrationRate:function(e){return p.a.round(e,3)},carbonStoredPerHectare:function(e){return p.a.round(e,2)},emissionsFactor:function(e){return p.a.round(e,4)},forecastYears:function(e){return p.a.round(Math.abs(e),2)},carbonPrice:function(e){return p.a.round(Math.abs(e),2)}},ae=n(34),oe={forecastYears:50,emissionsChartYAxis:"mtco2e",carbonPrice:5,seriesInputs:{}},re=Object(ae.b)({name:"widgetSettings",initialState:oe,reducers:{setForecastYears:function(e,t){var n=t.payload;e.forecastYears=n},resetForecastYears:function(e){e.forecastYears=oe.forecastYears},setEmissionsChartYAxis:function(e,t){var n=t.payload;["mtco2e","price"].includes(n)&&(e.emissionsChartYAxis=n)},setCarbonPrice:function(e,t){var n=t.payload;p.a.inRange(n,0,999)&&(e.carbonPrice=n)},createLocationSeriesInputs:function(e,t){var n,a,o=t.payload,r=o.locationID,s=o.inputParams;if(!r||!s)return e;if(!(null===(n=e.seriesInputs)||void 0===n||null===(a=n[r])||void 0===a?void 0:a[0])){var i=p.a.cloneDeep(e.seriesInputs);p.a.set(i,"[".concat(r,"][0]"),s),e.seriesInputs=i}},updateLocationSeriesInputs:function(e,t){var n,a=t.payload,o=a.locationID,r=a.seriesIndex,s=a.inputParams;if(!o||!p.a.isNumber(r)||!s)return e;var i=p.a.cloneDeep(e.seriesInputs),c=(null===i||void 0===i||null===(n=i[o])||void 0===n?void 0:n[r])||{};p.a.set(i,"[".concat(o,"][").concat(r,"]"),Object(d.a)(Object(d.a)({},c),s)),e.seriesInputs=i},addLocationSeriesInputs:function(e,t){var n=t.payload,a=n.locationID,o=n.inputParams;if(!a||!o)return e;e.seriesInputs[a].push(o)},removeLocationSeries:function(e,t){var n=t.payload,a=n.seriesIndex,o=n.locationID;if(0===a)return!1;e.seriesInputs[o]=e.seriesInputs[o].filter((function(e,t){return t!==a}))}}}),se=re.actions,ie=se.setForecastYears,ce=se.resetForecastYears,le=se.updateLocationSeriesInputs,ue=se.removeLocationSeries,de=se.addLocationSeriesInputs,be=se.createLocationSeriesInputs,je=se.setEmissionsChartYAxis,fe=se.setCarbonPrice,pe=re.reducer,me=function(e){var t=e.locationData,n=e.forecastYears,a=void 0===n?50:n,r=e.forecastStartingYear,s=void 0===r?2017:r,i=Object(o.useState)({}),l=Object(c.a)(i,2),u=l[0],j=l[1],f=Object(o.useState)([]),m=Object(c.a)(f,2),h=m[0],O=m[1],v=Object(o.useMemo)((function(){return null===t||void 0===t?void 0:t.id}),[t]),x=Object(b.c)((function(e){var t;return null===(t=e.widgetSettings.seriesInputs)||void 0===t?void 0:t[v]})),g=Object(b.b)();Object(o.useEffect)((function(){if(t){var e=Q({locationData:t});j(e),g(be({locationID:v,inputParams:e}))}else j({})}),[g,t,v]);var y=Object(o.useMemo)((function(){return(null===x||void 0===x?void 0:x.length)?x.map((function(e){return $({current_area_ha:e.current_area_ha,deforestationRate:e.deforestationRate,emissionsFactor:e.emissionsFactor,carbonStoredPerHectare:e.carbonStoredPerHectare,sequestrationRate:e.sequestrationRate,forecastYears:a})})):[]}),[a,x]);return Object(o.useEffect)((function(){if((null===x||void 0===x?void 0:x[0])&&u){var e=function(e){var t=e.a,n=e.b,a=e.roundValuesByKey,o=void 0===a?{}:a;return p.a.reduce(t,(function(e,t,a){var r=t,s=n[a];return p.a.isNumber(r)&&(null===o||void 0===o?void 0:o[a])&&(r=o[a](r),s=o[a](s)),p.a.isEqual(r,s)?e:e.concat(a)}),[])}({a:x[0],b:u,roundValuesByKey:ne});O(e)}else O([])}),[x,u]),{seriesResults:y,seriesInputs:x,userModifiedKeys:h,setInputParams:function(e){var t,n=e.index,a=e.inputParams;if(a=Object(d.a)(Object(d.a)({},a),{},{userHasModifiedParams:!0}),Object.keys(a).includes("deforestationRatePercent")){var o=a.deforestationRatePercent,r=(t=o,Math.log1p(t/100));a.deforestationRate=r}g(le({locationID:v,seriesIndex:n,inputParams:a}))},resetInputParams:function(e){var t=e.index,n=Object(d.a)(Object(d.a)({},u),{},{userHasModifiedParams:!1});g(le({locationID:v,seriesIndex:t,inputParams:n}))},addSeries:function(){g(de({locationID:v,inputParams:u}))},removeSeries:function(e){var t=e.index;g(ue({locationID:v,seriesIndex:t}))},forecastStartingYear:s,formatSeriesValuesByKey:ne}},he=Object(ae.b)({name:"globalSettings",initialState:{showMenuHelpText:!0},reducers:{hideMenuHelpText:function(e){e.showMenuHelpText=!1}}}),Oe=he.actions.hideMenuHelpText,ve=he.reducer,xe=(n(240),function(e){var t=e.setSelectedLocationData,n=Object(o.useRef)(),r=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,t=void 0===e?"country":e,n=Object(o.useState)([]),a=Object(c.a)(n,2),r=a[0],s=a[1],i=Object(o.useState)([]),l=Object(c.a)(i,2),u=l[0],j=l[1],f=Object(b.c)((function(e){return e.widgetSettings.forecastYears})),p=Object(b.c)((function(e){return e.widgetSettings.seriesInputs}));return Object(o.useEffect)((function(){X({type:t}).then((function(e){return s(e)}))}),[t]),Object(o.useEffect)((function(){if(null===r||void 0===r?void 0:r.length){console.time("Projected Emissions for all locations");var e=r.map((function(e){var t=e.current_area_ha,n=e.deforestationRate,a=e.carbonStoredPerHectare,o=p[e.id],r=(null===o||void 0===o?void 0:o[0])||{},s=null===r||void 0===r?void 0:r.userHasModifiedParams,i=z,c=J,l=$(Object(d.a)({current_area_ha:t,deforestationRate:n,emissionsFactor:i,carbonStoredPerHectare:a,sequestrationRate:c,forecastYears:f},r)),u=l[l.length-1];return Object(d.a)(Object(d.a)({},e),{},{emissionModelResults:l,emissionModelResultFinal:u,userHasModifiedParams:s})}));console.timeEnd("Projected Emissions for all locations"),j(e)}}),[r,f,p]),u}({type:"country"}),s=Object(b.c)((function(e){return e.widgetSettings.forecastYears})),i=Object(b.b)(),f=Object(o.useMemo)((function(){return(null===r||void 0===r?void 0:r.length)?"loaded":"loading"}),[r]),m=Object(o.useState)({latitude:20,longitude:0,zoom:2,minZoom:2}),O=Object(c.a)(m,2),x=O[0],g=O[1],S=Object(o.useState)({}),C=Object(c.a)(S,2),I=C[0],M=C[1],P=Object(o.useState)(null),T=Object(c.a)(P,2),R=T[0],E=T[1],A=Object(o.useState)({}),D=Object(c.a)(A,2),_=D[0],k=D[1],L=Object(o.useCallback)((function(e){var t=h()(e),n=Object(c.a)(t,4),a=n[0],o=n[1],r=n[2],s=n[3],i=new j.f(x).fitBounds([[a,o],[r,s]],{padding:{top:100,bottom:200,right:100,left:100},offset:[0,0]}),l=i.longitude,u=i.latitude,b=i.zoom,f=Object(d.a)(Object(d.a)({},x),{},{longitude:l,latitude:u,zoom:b,transitionDuration:1e3,transitionInterpolator:new j.a});g(f)}),[x]);Object(o.useEffect)((function(){var e=Object(u.a)(r);e=p.a.sortBy(e,"area_m2").reverse();var t="emissionModelResultFinal",n="".concat(s||0,"yr Projected Emissions"),a=e.map((function(e){return U(e[t])})),o=v()(a),i=p.a.ceil(o.quartile(.98),-2),c=i/6,b=p.a.range(0,i+c,c),j={colourKey:t,colourValueKey:"colour_normalised",colourKeyName:n,colourKeyUnit:"Mt CO\u2082e",min:0,max:i,valueStops:b,colourStops:N("Reds",6),opacity:.5},f=e.map((function(e){var n,a=e.geometry,o=e.bounds,r=Object(l.a)(e,["geometry","bounds"]),s=U(r[t]),i=(s-(n=j.min))/(j.max-n),c=p.a.clamp(Math.floor(6*i),0,5),u=j.colourStops[c];return{type:"Feature",geometry:a,properties:Object(d.a)(Object(d.a)({},r),{},{x:null===o||void 0===o?void 0:o.coordinates[0][0],y:null===o||void 0===o?void 0:o.coordinates[0][2],colour:u})}}));k(j),E(f)}),[r,s]);var Y={id:"data",type:"fill",paint:{"fill-opacity":_.opacity,"fill-outline-color":"black","fill-color":["get","colour"]}};return Object(a.jsxs)("div",{className:"Map",children:[Object(a.jsxs)(j.b,Object(d.a)(Object(d.a)({},x),{},{width:"100%",height:"100%",mapStyle:"mapbox://styles/ejinks-gu/ckhycntp61ol31am7qum156sk?optimize=true",onViewportChange:g,mapboxApiAccessToken:"pk.eyJ1IjoiZWppbmtzLWd1IiwiYSI6ImNrZ3B2NnJ1cDBkNWoycm1tNjllMGJpcjMifQ.VxxrxwEbNAbGtb-LwxWF-A",onHover:function(e){var t=e.features,n=e.srcEvent,a=n.offsetX,o=n.offsetY,r=t&&t.find((function(e){return"data"===e.layer.id}));M({hoveredFeature:r,x:a,y:o})},onMouseOut:function(){M({})},onClick:function(e){var n=e.features,a=n&&n.find((function(e){return"data"===e.layer.id}));a&&(L(a),t(null===a||void 0===a?void 0:a.properties),i(Oe()))},ref:n,getCursor:function(e){return e.isHovering?"pointer":(null===e||void 0===e?void 0:e.isDragging)?"grabbing":(null===I||void 0===I?void 0:I.hoveredFeature)?"crosshair":"grab"},children:[Object(a.jsx)(j.d,{className:"Map--NavigationControl",onViewportChange:g}),Object(a.jsx)(j.e,{type:"geojson",data:{type:"FeatureCollection",features:R},children:Object(a.jsx)(j.c,Object(d.a)(Object(d.a)({},Y),{},{beforeId:"country-label"}))}),function(){var e=I.hoveredFeature,t=I.x,n=I.y;if(!e)return null;var o=p.a.startCase(e.properties.location_type),r="".concat(e.properties.name," (").concat(e.properties.iso,")"),s=U(e.properties.emissionModelResultFinal).toFixed(1),i=e.properties.userHasModifiedParams;return e&&Object(a.jsxs)("div",{className:"Map--Tooltip",style:{left:t,top:n},children:[Object(a.jsxs)("div",{children:[o,": ",Object(a.jsx)("span",{className:"Map--Tooltip--Value",children:r})]}),Object(a.jsxs)("div",{children:["Projected Emissions:"," ",Object(a.jsxs)("span",{className:"Map--Tooltip--Value",children:[s," Mt"]})]}),Object(a.jsx)("div",{children:!!i&&Object(a.jsx)("span",{children:Object(a.jsx)("em",{children:"*user modified"})})})]})}()]})),Object(a.jsxs)("div",{className:"Map--Overlays",children:[Object(a.jsx)(F,{}),"loaded"===f&&Object(a.jsx)(w,{mapColours:_})]}),"loaded"!==f&&Object(a.jsx)(y,{style:{position:"absolute",top:"calc(50% - 33px)",left:"calc(50% - 33px)"}})]})}),ge=n(31),ye=function(e){var t=e.seriesResults,n=void 0===t?[]:t,r=e.forecastStartingYear,s=e.width,i=void 0===s?385:s,c=e.height,l=void 0===c?225:c,u=Object(b.c)((function(e){return e.widgetSettings.emissionsChartYAxis})),d=Object(b.c)((function(e){return e.widgetSettings.carbonPrice})),j=Object(o.useMemo)((function(){var e=1;return"price"===u&&(e=d/1e3),e}),[u,d]),f={price:{select:"USD",yAxis:"b",yAxisSmallValue:"m"},mtco2e:{select:"Mt CO\u2082e",yAxis:" Mt"}},m=ee({seriesResults:n,forecastStartingYear:r,conversionRate:j}),h=function(e){return p.a.round(U(e),2).toLocaleString()},O=function(e){return e},v=function(e){if(e<1e6&&f[u].yAxisSmallValue){var t=f[u].yAxisSmallValue;return"".concat(h(1e3*e)).concat(t)}var n=f[u].yAxis;return"".concat(h(e)).concat(n)};return Object(a.jsxs)(ge.d,{width:i,height:l,data:m,margin:{top:5,right:40,left:0,bottom:25},children:[Object(a.jsx)(ge.a,{strokeDasharray:"5 5",strokeOpacity:.5,vertical:!1}),Object(a.jsx)(ge.f,{dataKey:"name",axisLine:!1,tickMargin:5,tickCount:10,domain:[r-1,"dataMax"],tickFormatter:O,interval:"preserveStartEnd",type:"number",children:Object(a.jsx)(ge.b,{value:"Year",position:"bottom"})}),Object(a.jsx)(ge.g,{orientation:"right",axisLine:!1,tickFormatter:function(e){return function(e){if(e<1e6&&f[u].yAxisSmallValue){var t=f[u].yAxisSmallValue;return"".concat(h(1e3*e)).concat(t)}var n=f[u].yAxis;return"".concat(h(e)).concat(n)}(e)},type:"number",tickLine:!1,tickMargin:5}),Object(a.jsx)(ge.e,{labelFormatter:function(e,t,n){return function(e){return"".concat(e," emissions")}(e)},formatter:function(e,t,n){return[v(e),null]}}),n.map((function(e,t){return Object(a.jsx)(ge.c,{dataKey:"series_".concat(t),type:"monotone",stroke:M[t],strokeWidth:2,activeDot:{r:8},dot:!1},"series_".concat(t))}))]})},Se=n(179),Ce=n(178),Ie=n(176),Me=(n(415),function(e){var t=e.value,n=e.name,o=e.onChange,r=void 0===o?console.log:o,s=e.style,i=void 0===s?{}:s,c=e.unit,u=void 0===c?"":c,b=e.min,j=e.max,f=Object(l.a)(e,["value","name","onChange","style","unit","min","max"]),m=(t||0).toLocaleString(void 0,{maximumFractionDigits:20}).length+.5;return Object(a.jsxs)("span",{children:[Object(a.jsx)(Ie.a,Object(d.a)({className:"NumberInput",value:t,displayType:"input",thousandSeparator:!0,style:Object(d.a)(Object(d.a)({},i),{},{width:"".concat(m,"ch"),minWidth:25}),onValueChange:function(e){var t=e.floatValue;e.formattedValue;r({name:n,value:t})},isAllowed:function(e){var t=e.floatValue,n=!0;return p.a.isNumber(b)&&(n=t>=b),p.a.isNumber(j)&&(n=t<=j),n}},f))," ",u]})}),Ne=n(177);n(416);R.a.setAppElement("#root");var we=function(e){var t=e.content,n=e.title,r=e.className,s=void 0===r?"":r,i=Object(o.useState)(!1),l=Object(c.a)(i,2),u=l[0],d=l[1];function b(){d(!1)}return Object(a.jsxs)(o.Fragment,{children:[Object(a.jsx)(P,{Icon:Ne.a,className:"InfoPopup--InfoIcon ".concat(s),onClick:function(){d(!0)}}),Object(a.jsxs)(R.a,{isOpen:u,onAfterOpen:function(){},onRequestClose:b,className:"InfoPopup--Modal",overlayClassName:"InfoPopup--Overlay",children:[Object(a.jsx)(P,{Icon:E.a,className:"InfoPopup--CloseButton",onClick:b}),n&&Object(a.jsx)("h3",{className:"InfoPopup--Title",children:n}),Object(a.jsx)("div",{className:"InfoPopup--Content",children:t})]})]})},Pe=n(183),Te=(n(417),function(e){var t=e.title,n=e.children;return Object(a.jsx)(Pe.a,{content:t,interactive:!0,children:Object(a.jsx)("abbr",{title:t,children:n})})}),Re=(n(418),function(e){var t=e.title,n=e.unit,o=e.unitTitle,r=e.name,s=e.seriesInputs,i=void 0===s?[]:s,c=e.userModifiedKeys,l=e.valueFormatter,u=void 0===l?function(e){return e}:l,d=e.formatSeriesValuesByKey,b=void 0===d?{}:d,j=e.handleChange,f=e.min,p=e.max,m=e.infoPopupContent,h=e.infoPopupTitle,O=c.includes(r);return Object.keys(b).includes(r)&&(u=b[r]),Object(a.jsxs)("tr",{className:"EmissionsModelWidget--Table--Row",children:[Object(a.jsxs)("th",{className:"EmissionsModelWidget--Table--Row--Header",children:[Object(a.jsx)("span",{className:"EmissionsModelWidget--Table--Row--Header--Name",children:t}),!!n&&Object(a.jsxs)("span",{className:"EmissionsModelWidget--Table--Row--Header--Unit",children:[" ","(",Object(a.jsx)(Te,{title:o,children:n}),")"]}),m&&Object(a.jsx)(we,{content:m,title:h})]}),!i.length&&Object(a.jsx)(Ae,{}),i.map((function(e,t){return Object(a.jsx)(Ee,{name:r,isModified:0===t&&O,value:u(e[r]),index:t,handleChange:j,min:f,max:p},"".concat(r,"-").concat(t))}))]})}),Ee=function(e){var t=e.name,n=e.value,o=e.index,r=e.handleChange,s=e.min,i=e.max,c=e.isModified;return Object(a.jsx)("td",{className:"EmissionsModelWidget--Table--Row--ValueCell","data-ismodified":c,children:Object(a.jsx)(Me,{name:t,value:n,onChange:function(e){var t=e.name,n=e.value;return r({name:t,value:n,index:o})},min:s,max:i})})},Ae=function(){return Object(a.jsx)("td",{className:"EmissionsModelWidget--Table--Row--ValueCell",children:Object(a.jsx)("span",{className:"EmissionsModelWidget--Table--Row--ValueCellPlaceholder",children:" "})})},De=function(e){var t=e.seriesInputs,n=void 0===t?{}:t,o=e.formatSeriesValuesByKey,r=e.userModifiedKeys,s=e.setInputParams,i=e.resetInputParams,c=e.addSeries,l=e.removeSeries,u=e.forecastYears,d=e.setForecastYears,j=e.carbonPrice,f=e.setCarbonPrice,p=e.showCarbonPrice,m=e.isLoaded,h=e.exportCsv,O=Object(b.b)(),v=function(e){var t=e.name,n=e.value,a=e.index;s({index:a,inputParams:Object(k.a)({},t,n)})};return Object(a.jsx)("div",{className:"Widgets--Description",children:Object(a.jsxs)("table",{className:"EmissionsModelWidget--Table",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{}),n.length>1&&n.map((function(e,t){return Object(a.jsxs)("th",{className:"EmissionsModelWidget--Table--SeriesHeader",style:{color:M[t]},children:["Series ",t+1]},"thead-".concat(t))}))]})}),Object(a.jsxs)("tbody",{children:[Object(a.jsx)(Re,{title:"Mangrove extent",unit:"ha",unitTitle:"Hectares",name:"current_area_ha",seriesInputs:n,userModifiedKeys:r,handleChange:v,formatSeriesValuesByKey:o,infoPopupTitle:"Mangrove extent",infoPopupContent:"Area covered by mangroves measured in hectares."}),Object(a.jsx)(Re,{title:"Deforestation rate",unit:"% p.a.",unitTitle:"% per annum",name:"deforestationRatePercent",seriesInputs:n,userModifiedKeys:r,handleChange:v,formatSeriesValuesByKey:o,infoPopupTitle:"Deforestation rate",infoPopupContent:"Rate at which mangroves are cleared per annum measured in %"}),Object(a.jsx)(Re,{title:"Sequestration rate",unit:"t CO\u2082e p.a.",unitTitle:"Metric Tonnes of CO\u2082 equivalent per annum",name:"sequestrationRate",seriesInputs:n,userModifiedKeys:r,formatSeriesValuesByKey:o,handleChange:v,infoPopupTitle:"Sequestration rate",infoPopupContent:"Rate at which carbon is sequestered per annum measured in metric tonnes of CO\u2082e per annum."}),Object(a.jsx)(Re,{title:"Carbon stored",unit:"t CO\u2082e / ha",unitTitle:"Metric Tonnes of CO\u2082 equivalent per hectare",name:"carbonStoredPerHectare",seriesInputs:n,userModifiedKeys:r,handleChange:v,formatSeriesValuesByKey:o,infoPopupTitle:"Carbon stored",infoPopupContent:"The amount of carbon stored per hectare of mangroves that can be emitted, measured in metric tonnes of CO\u2082e per hectare."}),Object(a.jsx)(Re,{title:"Forecast Years",name:"forecastYears",seriesInputs:[{forecastYears:u}],userModifiedKeys:r,handleChange:function(e){e.name;var t=e.value;return d(t)},formatSeriesValuesByKey:o,infoPopupTitle:"Forecast Years",infoPopupContent:"The number of years you would like to see projections for."}),p&&Object(a.jsx)(Re,{title:"Carbon Price",name:"carbonPrice",unit:"USD / t",unitTitle:"US Dollars per metric tonne of CO\u2082 equivalent",seriesInputs:[{carbonPrice:j}],userModifiedKeys:r,handleChange:function(e){e.name;var t=e.value;return f(t)},formatSeriesValuesByKey:o,min:0,max:999,infoPopupTitle:"Carbon Price",infoPopupContent:"The cost per tonne of carbon in USD."})]}),Object(a.jsx)("tfoot",{children:Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{className:"EmissionsModelWidget--Table--FooterCell",style:{textAlign:"left"},children:[m&&Object(a.jsx)("button",{className:"button EmissionsModelWidget--Table--FooterButton",onClick:function(){return c()},children:"+ Add Series"}),m&&Object(a.jsxs)("button",{className:"button EmissionsModelWidget--Table--FooterButton",onClick:h,children:[Object(a.jsx)(Ce.a,{})," Export CSV"]})]}),n.map((function(e,t){return Object(a.jsxs)("td",{className:"EmissionsModelWidget--Table--FooterCell",children:[Object(a.jsx)("button",{className:"button EmissionsModelWidget--Table--FooterButton",onClick:function(){return function(e){var t=e.index;i({index:t}),0===t&&O(ce())}({index:t})},title:"Reset",children:Object(a.jsx)(Se.a,{})}),!!t>0&&Object(a.jsx)("button",{className:"button EmissionsModelWidget--Table--FooterButton",onClick:function(){return l({index:t})},title:"Remove",children:Object(a.jsx)(E.a,{})})]},"tfoot-".concat(t))}))]})})]})})},_e=n(180),Fe=(n(419),function(e){var t=e.options,n=void 0===t?[]:t,o=e.className,r=void 0===o?"":o,s=e.onChange,i=e.selectedValue,c=Object(l.a)(e,["options","className","onChange","selectedValue"]);return Object(a.jsxs)("span",Object(d.a)(Object(d.a)({className:"SelectInput--Wrap ".concat(r)},c),{},{children:[Object(a.jsx)("select",{className:"SelectInput--Input",onChange:function(e){s(e.target.value)},value:i,children:n.map((function(e){var t=e.name,n=e.value;return Object(a.jsx)("option",{value:n,children:t},"Select".concat(n))}))}),Object(a.jsx)(_e.a,{className:"SelectInput--Icon"})]}))}),ke=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return e.widgetSettings.emissionsChartYAxis}));return Object(a.jsx)(Fe,{options:[{name:"Mt CO\u2082e",value:"mtco2e"},{name:"Price (USD)",value:"price"}],onChange:function(t){e(je(t))},selectedValue:t})},Le=function(e){var t=e.selectedLocationData,n=e.exportCsvResultsFilenamePrefix,r=void 0===n?"MangroveCarbon_forecast_":n,s=function(e){var t=e.locationID,n=Object(o.useState)(),a=Object(c.a)(n,2),r=a[0],s=a[1],i=Object(o.useState)(),l=Object(c.a)(i,2),u=l[0],d=l[1];return Object(o.useEffect)((function(){t?(s(void 0),d("loading"),Z(t).then((function(e){s(e),d("loaded")}))):(s(void 0),d(void 0))}),[t]),{data:r,loadingState:u}}({locationID:null===t||void 0===t?void 0:t.id}),i=s.data,u=s.loadingState,j=Object(b.b)(),f=Object(b.c)((function(e){return e.widgetSettings.forecastYears})),m=Object(b.c)((function(e){return e.widgetSettings.emissionsChartYAxis})),h=Object(b.c)((function(e){return e.widgetSettings.carbonPrice})),O=me({locationData:i,forecastYears:f}),v=O.seriesResults,x=O.seriesInputs,g=void 0===x?[]:x,S=O.formatSeriesValuesByKey,C=O.userModifiedKeys,I=O.setInputParams,M=O.resetInputParams,N=O.addSeries,w=O.removeSeries,P=O.forecastStartingYear;return Object(a.jsxs)("div",{className:"Widgets--Box--Inner",children:["loaded"!==u&&Object(a.jsx)(y,{isSmall:!0,style:{position:"absolute",left:10,top:10}}),Object(a.jsxs)("div",{className:"Widgets--Box--Column",children:[Object(a.jsxs)("h3",{className:"Widgets--Title",children:[null===t||void 0===t?void 0:t.name," (",null===t||void 0===t?void 0:t.iso,")"]}),Object(a.jsx)(De,{seriesInputs:g,userModifiedKeys:C,formatSeriesValuesByKey:S,setInputParams:I,resetInputParams:M,addSeries:N,removeSeries:w,forecastYears:f,setForecastYears:function(e){return j(ie(e))},carbonPrice:h,showCarbonPrice:"price"===m,setCarbonPrice:function(e){return j(fe(e))},isLoaded:"loaded"===u,exportCsv:function(){var e=ee({seriesResults:v,forecastStartingYear:P}),t=function(e,t){var n=/series_(\d+)/g.exec(t),a=parseInt(n[1]);return"Series ".concat(a+1," (t CO2e)")};!function(e){te.apply(this,arguments)}({data:e.map((function(e){var n=e.name,a=Object(l.a)(e,["name"]),o=p.a.mapKeys(a,t);return Object(d.a)({Year:n},o)})),filename:"".concat(r).concat(new Date,".csv")})}})]}),Object(a.jsxs)("div",{className:"Widgets--Box--Column",children:[Object(a.jsxs)("h3",{className:"Widgets--Box--Column--Title",children:[Object(a.jsxs)("strong",{children:["Projected Emissions"," ",Object(a.jsx)(we,{title:"Projected Emissions",content:"price"===m?"Estimated projected emissions per annum measured in USD":"Cumulative projected emissions measured in megatonnes of CO\u2082e"})]}),Object(a.jsx)(ke,{})]}),Object(a.jsx)(ye,{seriesInputs:g,seriesResults:v,forecastStartingYear:P,width:385,height:250})]})]})},Ye=function(e){var t=e.children,n=e.onClose,o=Object(l.a)(e,["children","onClose"]);return Object(a.jsxs)("div",Object(d.a)(Object(d.a)({className:"Widgets--Box"},o),{},{children:[Object(a.jsx)(P,{Icon:E.a,className:"Widgets--Box--CloseButton",onClick:n}),t]}))},He=(n(420),function(e){var t=e.selectedLocationData,n=e.setSelectedLocationData;return t?Object(a.jsx)("div",{className:"Widgets--Wrap",children:Object(a.jsx)(Ye,{onClose:function(){return n(null)},children:Object(a.jsx)(Le,{selectedLocationData:t})})}):null});var We=function(){var e=Object(o.useState)(),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(a.jsxs)("div",{children:[Object(a.jsx)(xe,{setSelectedLocationData:r}),Object(a.jsx)(He,{selectedLocationData:n,setSelectedLocationData:r})]})},Be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,428)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),o(e),r(e),s(e)}))},Ve=n(181),Ke=n(16),qe=n(26),Ue=n(182),Ge=n.n(Ue),ze=Object(Ke.c)({widgetSettings:function(e){var t=e.key,n=e.reducer,a=e.config,o=void 0===a?{}:a,r=Object(d.a)({key:t,storage:Ge.a},o);return Object(qe.g)(r,n)}({reducer:pe,key:"widgetSettings"}),globalSettings:ve}),Je=Object(ae.a)({reducer:ze,middleware:Object(ae.c)({serializableCheck:{ignoredActions:[qe.a,qe.f,qe.b,qe.c,qe.d,qe.e]}})}),Xe=Object(qe.h)(Je);i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(b.a,{store:Je,children:Object(a.jsx)(Ve.a,{loading:null,persistor:Xe,children:Object(a.jsx)(We,{})})})}),document.getElementById("root")),Be(console.log)},74:function(e,t,n){e.exports={spinner:"Spinner_spinner__2xx15",rotator:"Spinner_rotator__HruCq",path:"Spinner_path__mmN71",dash:"Spinner_dash__2c4cX",colors:"Spinner_colors__2sF7p",pathSmall:"Spinner_pathSmall__1IDXM",dashSmall:"Spinner_dashSmall__3h2QR"}}},[[423,1,2]]]);
//# sourceMappingURL=main.1ca36eca.chunk.js.map